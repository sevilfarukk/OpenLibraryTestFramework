# Open Library Test Automation Framework

Playwright + TypeScript test automation framework for Open Library, designed for maintainability, scalability, and clear reporting.

## 1. Scope

This framework covers the following scenarios:

- Required API flow:
  - Search a book by title + author using `/search.json`
  - Extract `author_key` from first result
  - Request `/authors/{author_key}.json`
  - Validate J. K. Rowling website (`http://www.jkrowling.com/`)
  - Keep test data parameterized for easy extension
- Required UI flow:
  - Advanced search for `Harry Potter` and `Rowling`
  - Open `J. K. Rowling` from first result
  - Sort works by rating
  - Validate top displayed work is `Harry Potter and the Half-Blood Prince` (assessment requirement)
- Additional tests:
  - API author schema resilience validation
  - API cross-endpoint author consistency validation (`/search` -> `/authors`)
  - UI Trending sort persistence across pagination
  - UI `only ebooks` filter behavior on author page

## 2. Tech Stack and Rationale

### Chosen

- Playwright Test
- TypeScript
- ESLint + Prettier
- Allure + Playwright HTML reports
- GitHub Actions CI

### Why this stack

- Playwright supports API and UI in one runner with robust tracing and artifacts.
- TypeScript improves long-term maintainability and safe refactoring.
- Allure + HTML reporting gives both rich debugging and CI-friendly outputs.
- GitHub Actions integrates directly with GitHub delivery requirements.

## 3. Project Structure

```text
.
├── .github/workflows/test.yml
├── src
│   ├── clients
│   │   └── openLibrary.client.ts
│   ├── config
│   │   ├── constants.ts
│   │   └── env.ts
│   ├── data
│   │   └── authors.data.ts
│   ├── fixtures
│   │   ├── api.fixture.ts
│   │   └── ui.fixture.ts
│   ├── pages
│   │   ├── author.page.ts
│   │   ├── home.page.ts
│   │   └── searchResults.page.ts
│   ├── types
│   │   └── api.types.ts
│   └── utils
│       ├── logger.ts
│       └── schema.ts
├── tests
│   ├── api
│   │   ├── authors-schema.spec.ts
│   │   ├── authors.spec.ts
│   │   └── search-author-consistency.spec.ts
│   ├── ui
│   │   ├── author-ebooks-filter.spec.ts
│   │   ├── author-sorting.spec.ts
│   │   └── author-trending-persistence.spec.ts
├── playwright.config.ts
├── tsconfig.json
└── package.json
```

## 4. Prerequisites

- Node.js 20+
- npm 10+
- Internet access to [Open Library](https://openlibrary.org)

## 5. Setup

```bash
npm ci
npx playwright install --with-deps
```

Copy environment file if needed:

```bash
cp .env.example .env
```

Default values:

- `UI_BASE_URL=https://openlibrary.org`
- `API_BASE_URL=https://openlibrary.org`

## 6. How To Run Locally

1. Install dependencies:

```bash
npm ci
```

2. Install Playwright browsers:

```bash
npx playwright install --with-deps
```

3. Configure environment variables:

```bash
cp .env.example .env
```

4. Run all tests:

```bash
npm run test
```

5. Open reports:

```bash
npm run report:html
npm run report:allure
npx allure open ./allure-report
```

## 7. Reporting

Playwright HTML report:

```bash
npm run report:html
```

Generate Allure report:

```bash
npm run report:allure
```

Open Allure report locally:

```bash
npx allure open ./allure-report
```

If the `allure` command is not available in your shell, use:

```bash
npx allure-commandline open ./allure-report
```

Report artifacts generated by CI:

- `playwright-report/`
- `allure-results/`
- `test-results/` (screenshots, traces, videos on failures)

## 8. Screenshots

- Screenshot capture is configured in `playwright.config.ts`:
  - `screenshot: 'only-on-failure'`
- Screenshot output folder:
  - `/test-results/`
- Typical screenshot filename:
  - `test-failed-1.png`
- List screenshots generated from failed tests:

```bash
find test-results -name 'test-failed-*.png'
```

## 9. Code Quality Gates

```bash
npm run lint          # Static lint checks (ESLint)
npm run format:check  # Formatting checks (Prettier)
npx tsc --noEmit      # Type checks only (no build artifacts)
```

## 10. CI Pipeline

GitHub Actions workflow is at:

- `/.github/workflows/test.yml`

Pipeline stages:

1. Install dependencies
2. Install Playwright browsers
3. Lint + format check
4. Run full test suite
5. Upload reports/artifacts
